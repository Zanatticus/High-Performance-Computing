# High-Performance Computing Final Project Code



[ingare.a@explorer-02 code]$ sinfo -p courses-gpu -o "%N %G"
NODELIST GRES
c[2184,2188] gpu:p100:3(S:0-1)
c[2185-2187,2193-2195] gpu:p100:4(S:0-1)
d1004 gpu:v100-sxm2:4(S:0-1)

THERE ARE DIFFERENT P100s. MAKE NOTE ON THE GPU MEMORY TYPE


foir the STL dataset, i have to manually set the size of the shared memory for each block since the size of the image (108 KB) is too big for the default (48 KB) shared memory size. This is overridden at runtime for V100, P100, and A100



https://ryli.design/blog/knn






```
=== Testing KNN on MNIST dataset ===
MNIST Train Size: 60000
MNIST Test Size: 10000
KNN: Loaded MNIST training data with 60000 images of size 784
MNIST Test Image Actual Label: 7
MNIST Test Image Predicted Label: 7
KNN: Processed 1000/10000 test images. Current accuracy: 96.1%
KNN: Processed 2000/10000 test images. Current accuracy: 95.65%
KNN: Processed 3000/10000 test images. Current accuracy: 95.3667%
KNN: Processed 4000/10000 test images. Current accuracy: 95.5%
KNN: Processed 5000/10000 test images. Current accuracy: 95.46%
KNN: Processed 6000/10000 test images. Current accuracy: 95.8667%
KNN: Processed 7000/10000 test images. Current accuracy: 96.2%
KNN: Processed 8000/10000 test images. Current accuracy: 96.575%
KNN: Processed 9000/10000 test images. Current accuracy: 96.8333%
KNN: Processed 10000/10000 test images. Current accuracy: 96.88%
KNN: Final accuracy: 96.88%
KNN: Total evaluation time: 47.9018 seconds
KNN: GPU memory usage: 182 MB

=== Testing KNN on CIFAR dataset ===
CIFAR Train Size: 50000
CIFAR Test Size: 10000
KNN: Loaded CIFAR training data with 50000 images of size 3072
CIFAR Test Image Actual Label: 3 (cat)
CIFAR Test Image Predicted Label: 2 (bird)
KNN: Processed 1000/10000 test images. Current accuracy: 34.7%
KNN: Processed 2000/10000 test images. Current accuracy: 33.75%
KNN: Processed 3000/10000 test images. Current accuracy: 33.9667%
KNN: Processed 4000/10000 test images. Current accuracy: 33.875%
KNN: Processed 5000/10000 test images. Current accuracy: 33.9%
KNN: Processed 6000/10000 test images. Current accuracy: 33.6333%
KNN: Processed 7000/10000 test images. Current accuracy: 33.9%
KNN: Processed 8000/10000 test images. Current accuracy: 34.0125%
KNN: Processed 9000/10000 test images. Current accuracy: 34.0333%
KNN: Processed 10000/10000 test images. Current accuracy: 33.98%
KNN: Final accuracy: 33.98%
KNN: Total evaluation time: 157.163 seconds
KNN: GPU memory usage: 586 MB
```



Dataset,K,ExecutionTime(s),Accuracy(%),MemoryUsage(MB),GPUType,GPUCount
MNIST,1,4.6814,96.9100,182.0000,NVIDIA A100-SXM4-40GB,1
CIFAR,1,13.1283,35.3900,586.0000,NVIDIA A100-SXM4-40GB,1
MNIST,1,4.6844,96.9100,182.0000,NVIDIA A100-SXM4-40GB,1
CIFAR,1,13.1471,35.3900,586.0000,NVIDIA A100-SXM4-40GB,1
MNIST,1,5.1386,4.6872,96.9100,182.0000,NVIDIA A100-SXM4-40GB,1
CIFAR,1,13.9243,13.1364,35.3900,586.0000,NVIDIA A100-SXM4-40GB,1
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.7706,0.0000,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,15.4906,0.0000,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.3775,0.0000,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.8695,0.0000,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.4058,0.0000,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.7311,0.0000,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.3753,0.0000,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,15.5814,0.0000,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.1102,0.0000,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.9719,0.0000,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.1928,0.0000,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.9081,0.0000,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.1116,4.6757,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.8960,0.0000,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.0938,4.6723,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.7344,13.1855,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.0963,4.6752,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.7866,13.1835,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.1024,4.6799,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.8134,13.1835,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.4302,4.6573,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.6946,13.1371,586.0000,12.3200
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.5029,4.6611,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.7588,13.1430,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.4362,4.6438,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.7407,13.1518,586.0000,12.3200
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.5643,4.6619,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.8230,13.1519,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.4344,4.6721,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.9427,13.1414,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.4802,4.6714,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.7988,13.1396,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.4876,4.6676,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.7538,13.1334,586.0000,35.3900
MNIST,1,NVIDIA A100-SXM4-40GB,1,5.4687,4.6658,182.0000,96.9100
CIFAR,1,NVIDIA A100-SXM4-40GB,1,13.6864,13.1384,586.0000,35.3900
MNIST,1,Tesla P100-PCIE-12GB,1,48.6576,48.2307,182.0000,96.9100
CIFAR,1,Tesla P100-PCIE-12GB,1,158.7978,157.6283,586.0000,35.3900
MNIST,51,Tesla P100-PCIE-12GB,1,48.9440,48.3710,182.0000,95.3300
CIFAR,51,Tesla P100-PCIE-12GB,1,159.0982,158.0206,586.0000,32.4800
MNIST,51,NVIDIA A100-SXM4-40GB,1,5.4258,4.6720,182.0000,95.3300
CIFAR,51,NVIDIA A100-SXM4-40GB,1,13.9066,13.1125,586.0000,32.4800
MNIST,51,NVIDIA A100-SXM4-40GB,1,5.4103,4.6734,182.0000,95.3300
CIFAR,51,NVIDIA A100-SXM4-40GB,1,13.8484,13.1050,586.0000,32.4800
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.3951,4.6810,182.0000,96.8800
CIFAR,5,NVIDIA A100-SXM4-40GB,1,13.8416,13.1020,586.0000,33.9800
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.3588,4.6776,182.0000,96.8800
CIFAR,5,NVIDIA A100-SXM4-40GB,1,13.6810,13.1015,586.0000,33.9800
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.3273,4.6807,182.0000,96.8800
CIFAR,5,NVIDIA A100-SXM4-40GB,1,13.8270,13.0972,586.0000,33.9800
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.2191,4.6754,182.0000,96.8800
CIFAR-10,5,NVIDIA A100-SXM4-40GB,1,13.7233,13.0894,588.0000,33.9800
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.2318,4.6691,182.0000,96.8800
CIFAR-10,5,NVIDIA A100-SXM4-40GB,1,13.9224,13.0873,588.0000,33.9800
STL-10,5,NVIDIA A100-SXM4-40GB,1,44.7406,43.7887,530.0000,26.9250
STL-10,15,NVIDIA A100-SXM4-40GB,1,44.7528,43.8049,530.0000,26.5000
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.2384,4.6607,182.0000,96.8800
CIFAR-10,5,NVIDIA A100-SXM4-40GB,1,13.6676,13.1046,588.0000,33.9800
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.3540,4.7389,182.0000,96.8800
STL-10,5,NVIDIA A100-SXM4-40GB,1,44.1819,43.1871,530.0000,26.9250
MNIST,5,NVIDIA A100-SXM4-40GB,1,5.2117,4.6841,182.0000,96.8800
CIFAR-10,5,NVIDIA A100-SXM4-40GB,1,13.6805,13.0941,588.0000,33.9800
STL-10,5,NVIDIA A100-SXM4-40GB,1,43.5679,43.0899,530.0000,26.9250
MNIST,5,Tesla P100-PCIE-12GB,1,48.1815,47.3794,182.0000,96.8800
CIFAR-10,5,Tesla P100-PCIE-12GB,1,159.3803,157.3173,588.0000,33.9800
MNIST,5,Tesla V100-SXM2-32GB,1,9.1296,8.4668,182.0000,96.8800
CIFAR-10,5,Tesla V100-SXM2-32GB,1,38.3033,35.5580,588.0000,33.9800
STL-10,5,NVIDIA A100-SXM4-40GB,1,5.2169,1.3541,530.0000,10.0000
STL-10,5,Tesla V100-SXM2-32GB,1,43.6067,42.5947,530.0000,26.9250
STL-10,5,Tesla V100-SXM2-32GB,1,43.6378,42.6537,530.0000,26.9250
STL-10,5,Tesla P100-PCIE-12GB,1,62.4946,61.3025,530.0000,26.9250
STL-10,5,NVIDIA A100-SXM4-40GB,1,44.2638,43.3103,530.0000,26.9250
STL-10,5,NVIDIA A100-SXM4-40GB,1,44.1804,43.3142,530.0000,26.9250
STL-10,5,NVIDIA A100-SXM4-40GB,1,44.3781,43.3109,530.0000,26.9250
STL-10,5,NVIDIA A100-SXM4-40GB,1,44.8368,43.9630,530.0000,26.9250
